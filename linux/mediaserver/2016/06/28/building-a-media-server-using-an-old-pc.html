<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" href="//weyts.xyz/assets/favicons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="//weyts.xyz/assets/favicons/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="57x57" href="//weyts.xyz/assets/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="72x72" href="//weyts.xyz/assets/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="//weyts.xyz/assets/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="//weyts.xyz/assets/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="//weyts.xyz/assets/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="//weyts.xyz/assets/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="//weyts.xyz/assets/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="//weyts.xyz/assets/favicons/apple-touch-icon-180x180.png">
  <title>Building a media server using an old pc</title>
  <meta name="description" content="A week ago I ordered computer parts on Amazon &amp; built a completely new PC for my dad. His old PC had become so slow, it was unbearable.It didn’t have an ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://blog.weyts.xyz/linux/mediaserver/2016/06/28/building-a-media-server-using-an-old-pc.html">
  <link rel="alternate" type="application/rss+xml" title="Blog &middot; Arnaud Weyts" href="https://blog.weyts.xyz/feed.xml">
</head>


  <body>

    
<header class="site-header text-center">

  <div class="wrapper">
    <a class="site-title" href="/">
      &lt;blog id="arnaud"&gt;
    </a>
    
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Building a media server using an old pc</h1>
    <p class="post-meta"><time datetime="2016-06-28T06:20:00+00:00" itemprop="datePublished">Jun 28, 2016</time></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>A week ago I ordered computer parts on Amazon &amp; built a completely new PC for my dad. His old PC had become so slow, it was unbearable.
It didn’t have an SSD, so that explains a lot. But to be honest it wasn’t just the HDD. His computer was just really, really old. His motherboard was still running legacy power, and his processor was pretty much done for too. So I decided to build him a new one.</p>

<p>I still had some parts laying around from my old computer that weren’t completely outdated (Intel Core Duo E8400, a decent motherboard). So I decided to use the case and HDD from my dad’s ancient computer and my old parts to create a Frankenstein media server. Turns out old computers with decent enough processors make freaking great media servers. I re-pasted the processor, cleaned it out a bit and it was up and running in minutes.</p>

<p>I’ll go through the steps to make a simple home file server (accessible by Windows, Linux &amp; macOS), that also allows for remote torrent downloading and can also be used to stream media on devices using Plex server.</p>

<h1 id="choosing-your-operating-system">Choosing your operating system</h1>
<p>This simple setup is most likely also possible on a Windows server OS, or any Linux server distribution, but I chose for <strong>Ubuntu Server 16.04 LTS</strong>, it’s convenient, and Ubuntu is usually a tad easier to set up than other distributions like Arch Linux. 16.04 got released only months ago, and it’s a long term support version, so that will also come in handy.</p>

<h1 id="making-an-installation-media">Making an installation media</h1>
<p>After you chose your preferred OS, you’re gonna have to download the <code class="highlighter-rouge">.iso</code> file and create a bootable installation media.
You can easily install Linux distributions using UNetbootin, you can select the distribution from the dropdown, or you can choose your own ISO, I did the latter.</p>

<h1 id="installing-and-setting-up-the-os">Installing and setting up the OS</h1>
<p>Reboot into the bootable media you just created, and run through the setup. Ubuntu server has a simple GUI setup so it shouldn’t be that hard.
After the install finishes, you can boot back into your Ubuntu hard drive, and you’ll be greeted with a simple terminal window. Ubuntu server doesn’t ship with a GUI, to make the OS simple and fast. Just log in with your account and we’ll get started by updating all of our packages:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo apt-get update
<span class="gp">$ </span>sudo apt-get upgrade
</code></pre>
</div>

<p>Now that that’s out of the way, we’ll set a static IP for the server, so we always know where to access it, we’ll have to edit a config file for this. You can check out the current IP for your server by entering:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>ifconfig
</code></pre>
</div>

<p>Keep note of your current IP (or a different one if you prefer), and your interface name.</p>

<p>Next you can edit the config file using your preferred text editor:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo vim /etc/network/interfaces
</code></pre>
</div>

<p>Using your own network settings, this is what your config file should look like:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>auto eth0
iface eth0 inet static
  address 192.168.1.69
  netmask 255.255.255.0
  network 192.168.1.0
  broadcast 192.168.1.255
  gateway 192.168.1.1
</code></pre>
</div>

<p>Now we’ll restart the network service.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo systemctl restart network
</code></pre>
</div>

<p>Once that’s finished, we’ll install all the extra packages we’ll be using. OpenSSH to manage the server remotely, packages for the file server, and transmission. Transmission will be used to host a web interface for torrent downloads.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo apt-get install openssh-server smbclient cifs-utils ntp
  ntpdate transmission-cli transmission-common transmission-daemon
</code></pre>
</div>

<p>Time to create the directories we’ll be sharing on the network, you’re basically free to put these wherever, but I would recommend creating something like <code class="highlighter-rouge">/var/files</code> and having a some subdirectories in there, that’s what i’ll be doing.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo mkdir /var/files
<span class="gp">$ </span>sudo mkdir /var/files/public
<span class="gp">$ </span>sudo mkdir /var/files/torrents
<span class="gp">$ </span>sudo chmod -R 775 /var/files/public
<span class="gp">$ </span>sudo chmod -R 775 /var/files/torrents
<span class="c"># optional sticky bit, so a user can't delete other files</span>
<span class="gp">$ </span>sudo chmod -t /var/files/public
<span class="gp">$ </span>sudo chmod -t /var/files/torrents
</code></pre>
</div>

<p>Now comes the most important part, editing the samba configuration to match your setup.
First let’s make a backup copy of the file, just to be safe:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.orig
</code></pre>
</div>

<p>Now you can edit it using your favorite text editor:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo vim /etc/samba/smb.conf
</code></pre>
</div>

<p>I recommend you read through the entire configuration file, as every single setting is explained in detail.
Here are some of the most important settings:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="c"># set your workgroup, this is important for windows,</span>
<span class="c"># the client will need to be in this workgroup</span>
workgroup <span class="o">=</span> EXAMPLENAME
<span class="c"># set windows support</span>
wins support <span class="o">=</span> yes
<span class="c"># uncomment this line</span>
name resolve order <span class="o">=</span> lmhosts hosts wins bcast
<span class="c"># uncomment this line</span>
security <span class="o">=</span> user

<span class="c"># add this to the end of the file for your own directories</span>
<span class="o">[</span>Public Files]
  comment <span class="o">=</span> Public Files
  path <span class="o">=</span> /var/files/public
  browseable <span class="o">=</span> yes
  <span class="nb">readonly</span> <span class="o">=</span> no
<span class="o">[</span>Torrents]
  comment <span class="o">=</span> Torrents
  path <span class="o">=</span> /var/files/torrents
  browseable <span class="o">=</span> yes
  <span class="nb">readonly</span> <span class="o">=</span> no
</code></pre>
</div>

<p>Let’s set a samba password, for security reasons.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo smbpasswd -a username
</code></pre>
</div>

<p>Now let’s setup our transmission daemon, we’ll start by adding our user to the transmission group and setting the permissions right.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo usermod -a -G debian-transmission username
<span class="gp">$ </span>sudo chgrp -R debian-transmission /var/files/torrents
</code></pre>
</div>

<p>Next we’ll edit the config file:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo vim /var/lib/transmission-daemon/info/settings.json
</code></pre>
</div>

<p>Now in the config file set the <code class="highlighter-rouge">"umask": 2</code> instead of the default 18.
I also recommend changing the transmission user password: <code class="highlighter-rouge">"rpc-password": examplepassword</code>.
You can find more information <a href="https://help.ubuntu.com/community/TransmissionHowTo#Configure">here</a>.
Make sure the transmission-daemon is enabled.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo systemctl <span class="nb">enable </span>transmission-daemon
</code></pre>
</div>

<p>Now that’s all done, we’re basically ready to reboot our server and load all the new daemons from boot.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo reboot
</code></pre>
</div>

<h1 id="all-done">All done!</h1>
<p>And that’s it, when your server has rebooted, the file server will be up and running, and so will the transmission server.
You can now upload magnet links or .torrent files via the web interface. Navigate to your server’s ip and the default transmission port to check it out: <code class="highlighter-rouge">192.168.1.69:9091</code>.
You might be prompted with a login, just login with your own user or the transmission user you set. From here you can configure any extra settings transmission might need, the web interface offers exactly the same settings as the actual Transmission client.</p>

<p>Remember to configure the default download folder to <code class="highlighter-rouge">/var/files/torrents</code> or whatever folder you like. This can also be done using the <code class="highlighter-rouge">settings.json</code> file, but the web interface works fine too.</p>

<p>Another thing to remember is to add the windows clients to the correct workgroup we configured previously! More info <a href="https://windowsinstructed.com/how-to-change-workgroup-in-windows-10/">here</a>.</p>

<h1 id="questions-feedback-or-improvements-drop-them-down-below">Questions, feedback or improvements? Drop them down below!</h1>

  </div>

</article>

<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
        this.page.url = "";  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = ""; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = '//arnaudweytsblog.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Blog &middot; Arnaud Weyts</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>Blog &middot; Arnaud Weyts</li>
          <li><a href="mailto:arnaud@weyts.xyz">arnaud@weyts.xyz</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/ArnaudWeyts"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">ArnaudWeyts</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/ArnaudWeyts"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">ArnaudWeyts</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>This is a simple blog using Jekyll.
&lt;/blog&gt;</p>
      </div>
    </div>
  </div>
</footer>


  </body>

</html>
